!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("echarts")):"function"==typeof define&&define.amd?define(["echarts"],e):"object"==typeof exports?exports.amap=e(require("echarts")):t.amap=e(t.echarts)}(window,function(t){return function(t){var e={};function o(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,o),a.l=!0,a.exports}return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=1)}([function(e,o){e.exports=t},function(t,e,o){"use strict";o.r(e);var n=o(0);function a(t,e){this._amap=t,this.dimensions=["lng","lat"],this._mapOffset=[0,0],this._api=e}function r(t,e){return e=e||[0,0],n.util.map([0,1],function(o){var n=e[o],a=t[o]/2,r=[],i=[];return r[o]=n-a,i[o]=n+a,r[1-o]=i[1-o]=e[1-o],Math.abs(this.dataToPoint(r)[o]-this.dataToPoint(i)[o])},this)}a.prototype.dimensions=["lng","lat"],a.prototype.setZoom=function(t){this._zoom=t},a.prototype.setCenter=function(t){this._center=this._amap.lnglatToPixel(new AMap.LngLat(t[0],t[1]))},a.prototype.setMapOffset=function(t){this._mapOffset=t},a.prototype.getAMap=function(){return this._amap},a.prototype.dataToPoint=function(t){var e=new AMap.LngLat(t[0],t[1]),o=this._amap.lngLatToContainer(e),n=this._mapOffset;return[o.x-n[0],o.y-n[1]]},a.prototype.pointToData=function(t){var e=this._mapOffset,o=this._amap.containerToLngLat(AMap.Pixel(t[0]+e[0],t[1]+e[1]));return[o.lng,o.lat]},a.prototype.getViewRect=function(){var t=this._api;return new n.graphic.BoundingRect(0,0,t.getWidth(),t.getHeight())},a.prototype.getRoamTransform=function(){return n.matrix.create()},a.prototype.prepareCustoms=function(t){var e=this.getViewRect();return{coordSys:{type:"amap",x:e.x,y:e.y,width:e.width,height:e.height},api:{coord:n.util.bind(this.dataToPoint,this),size:n.util.bind(r,this)}}},a.dimensions=a.prototype.dimensions,a.create=function(t,e){var o,n=e.getDom();t.eachComponent("amap",function(t){var r=e.getZr().painter,i=r.getViewportRoot();if("undefined"==typeof AMap)throw new Error("AMap api is not loaded");if(o)throw new Error("Only one amap component can exist");if(!t.__amap){var p=n.querySelector(".ec-extension-amap");p&&(i.style.left="0px",i.style.top="0px",n.removeChild(p)),(p=document.createElement("div")).style.cssText="width:100%;height:100%",p.classList.add("ec-extension-amap"),n.appendChild(p);var s=t.get(),f=t.__amap=new AMap.Map(p,s),c=new AMap.CustomLayer(i,{zIndex:s.echartsLayerZIndex});t.__echartsLayer=c,f.add(c),r.getViewportRootOffset=function(){return{offsetLeft:0,offsetTop:0}}}var d=(f=t.__amap).getCenter(),u=f.getZoom();(o=new a(f,e)).setMapOffset(t.__mapOffset||[0,0]),o.setZoom(u),o.setCenter([d.lng,d.lat]),t.coordinateSystem=o}),t.eachSeries(function(t){"amap"===t.get("coordinateSystem")&&(t.coordinateSystem=o)})};var i=a;n.extendComponentModel({type:"amap",getAMap:function(){return this.__amap},setCenterAndZoom:function(t,e){this.option.center=t,this.option.zoom=e},centerOrZoomChanged:function(t,e){var o,n,a=this.option;return o=t,n=a.center,!(o&&n&&o[0]===n[0]&&o[1]===n[1]&&e===a.zoom)},defaultOption:{center:[116.397428,39.90923],zoom:5,isHotspot:!1,echartsLayerZIndex:2e3}}),n.extendComponentView({type:"amap",render:function(t,e,o){var a=!0,r=t.getAMap(),i=t.__echartsLayer,p=o.getZr().painter.getViewportRoot(),s=t.coordinateSystem,f=function(e){if(!a){var n=p.parentNode.parentNode.parentNode,r=[-parseInt(n.style.left,10)||0,-parseInt(n.style.top,10)||0];p.style.left=r[0]+"px",p.style.top=r[1]+"px",s.setMapOffset(r),t.__mapOffset=r,o.dispatchAction({type:"amapRoam"})}},c=function(t){a||i.setOpacity(0)},d=function(t){a||(i.setOpacity(1),o.dispatchAction({type:"amapRoam"}))},u=function(t){n.getInstanceByDom(o.getDom()).resize(),f.call(this,t)},m=r.getStatus().resizeEnable;r.off("movestart",this._oldMoveHandler),r.off("moveend",this._oldZoomEndHandler),r.off("complete",this._oldZoomEndHandler),r.off("zoomstart",this._oldZoomStartHandler),r.off("zoomend",this._oldZoomEndHandler),m&&r.off("resize",this._oldResizeHandler),r.on("movestart",f),r.on("moveend",d),r.on("complete",d),r.on("zoomstart",c),r.on("zoomend",d),m&&r.on("resize",u),this._oldMoveHandler=f,this._oldZoomStartHandler=c,this._oldZoomEndHandler=d,m&&(this._oldResizeHandler=u),a=!1},dispose:function(){}});o.d(e,"version",function(){return p}),n.registerCoordinateSystem("amap",i),n.registerAction({type:"amapRoam",event:"amapRoam",update:"updateLayout"},function(t,e){e.eachComponent("amap",function(t){var e=t.getAMap(),o=e.getCenter();t.setCenterAndZoom([o.lng,o.lat],e.getZoom())})});var p="1.0.0-rc.1"}])});
//# sourceMappingURL=echarts-extension-amap.min.js.map