!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("echarts")):"function"==typeof define&&define.amd?define(["echarts"],e):"object"==typeof exports?exports.amap=e(require("echarts")):t.amap=e(t.echarts)}(window,(function(t){return function(t){var e={};function o(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,o),a.l=!0,a.exports}return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=2)}([function(e,o){e.exports=t},function(t){t.exports=JSON.parse('{"a":"echarts-extension-amap","b":"1.1.0"}')},function(t,e,o){"use strict";o.r(e),o.d(e,"version",(function(){return n.b})),o.d(e,"name",(function(){return n.a}));var n=o(1),a=o(0);function r(t,e){this._amap=t,this.dimensions=["lng","lat"],this._mapOffset=[0,0],this._api=e}function i(t,e){return e=e||[0,0],a.util.map([0,1],(function(o){var n=e[o],a=t[o]/2,r=[],i=[];return r[o]=n-a,i[o]=n+a,r[1-o]=i[1-o]=e[1-o],Math.abs(this.dataToPoint(r)[o]-this.dataToPoint(i)[o])}),this)}r.prototype.dimensions=["lng","lat"],r.prototype.setZoom=function(t){this._zoom=t},r.prototype.setCenter=function(t){this._center=this._amap.lnglatToPixel(new AMap.LngLat(t[0],t[1]))},r.prototype.setMapOffset=function(t){this._mapOffset=t},r.prototype.getAMap=function(){return this._amap},r.prototype.dataToPoint=function(t){var e=new AMap.LngLat(t[0],t[1]),o=this._amap.lngLatToContainer(e),n=this._mapOffset;return[o.x-n[0],o.y-n[1]]},r.prototype.pointToData=function(t){var e=this._mapOffset,o=this._amap.containerToLngLat(AMap.Pixel(t[0]+e[0],t[1]+e[1]));return[o.lng,o.lat]},r.prototype.getViewRect=function(){var t=this._api;return new a.graphic.BoundingRect(0,0,t.getWidth(),t.getHeight())},r.prototype.getRoamTransform=function(){return a.matrix.create()},r.prototype.prepareCustoms=function(t){var e=this.getViewRect();return{coordSys:{type:"amap",x:e.x,y:e.y,width:e.width,height:e.height},api:{coord:a.util.bind(this.dataToPoint,this),size:a.util.bind(i,this)}}},r.dimensions=r.prototype.dimensions,r.create=function(t,e){var o,n=e.getDom();t.eachComponent("amap",(function(t){var a=e.getZr().painter,i=a.getViewportRoot();if("undefined"==typeof AMap)throw new Error("AMap api is not loaded");if(o)throw new Error("Only one amap component can exist");var s,p,c,f,d=t.getAMap();if(!d){var u=n.querySelector(".ec-extension-amap");u&&(i.style.left="0px",i.style.top="0px",n.removeChild(u)),(u=document.createElement("div")).style.cssText="width:100%;height:100%",u.classList.add("ec-extension-amap"),n.appendChild(u);var m=t.get();d=new AMap.Map(u,m),t.setAMap(d);var l=new AMap.CustomLayer(i,{zIndex:m.echartsLayerZIndex});t.setEchartsLayer(l),d.add(l),m.renderOnMoving&&i.parentNode.classList.add("not-zoom"),s=".amap-e.not-zoom",p="left: 0!important;top: 0!important;",c=1/0,f=document.getElementsByClassName("AMap.style")[0].sheet,c=c||0,f.insertRule?f.insertRule(s+"{"+p+"}",c):f.addRule&&f.addRule(s,p,c),a.getViewportRootOffset=function(){return{offsetLeft:0,offsetTop:0}}}var h=t.get("center"),y=t.get("zoom");if(h&&y){var g=d.getCenter(),v=d.getZoom();if(t.centerOrZoomChanged([g.lng,g.lat],v)){var _=new AMap.LngLat(h[0],h[1]);d.setZoomAndCenter(y,_)}}(o=new r(d,e)).setMapOffset(t.__mapOffset||[0,0]),o.setZoom(y),o.setCenter(h),t.coordinateSystem=o})),t.eachSeries((function(t){"amap"===t.get("coordinateSystem")&&(t.coordinateSystem=o)}))};var s=r;a.extendComponentModel({type:"amap",setAMap:function(t){this.__amap=t},getAMap:function(){return this.__amap},setEchartsLayer:function(t){this.__echartsLayer=t},getEChartsLayer:function(){return this.__echartsLayer},setCenterAndZoom:function(t,e){this.option.center=t,this.option.zoom=e},centerOrZoomChanged:function(t,e){var o,n,a=this.option;return o=t,n=a.center,!(o&&n&&o[0]===n[0]&&o[1]===n[1]&&e===a.zoom)},defaultOption:{center:[116.397428,39.90923],zoom:5,isHotspot:!1,echartsLayerZIndex:2e3,renderOnMoving:!0}}),a.extendComponentView({type:"amap",render:function(t,e,o){var n=!0,r=t.getAMap(),i=o.getZr().painter.getViewportRoot(),s=t.coordinateSystem,p=r.getContainer(),c=t.get("renderOnMoving"),f=r.getStatus().resizeEnable,d=function(e){if(!n){var a=[-parseInt(p.style.left,10)||0,-parseInt(p.style.top,10)||0];i.style.left=a[0]+"px",i.style.top=a[1]+"px",s.setMapOffset(a),t.__mapOffset=a,o.dispatchAction({type:"amapRoam"})}},u=function(t){c&&p.querySelector(".amap-e").classList.remove("not-zoom");d.call(this,t)},m=function(t){if(!n){if(c)p.querySelector(".amap-e").classList.add("not-zoom");o.dispatchAction({type:"amapRoam"})}},l=function(t){a.getInstanceByDom(o.getDom()).resize(),d.call(this,t)};c?r.off("mapmove",this._oldMoveHandler):r.off("moveend",this._oldMoveHandler),r.off("zoomstart",this._oldZoomStartHandler),r.off("zoomend",this._oldZoomEndHandler),f&&r.off("resize",this._oldResizeHandler),c?r.on("mapmove",d):r.on("moveend",d),r.on("zoomstart",u),r.on("zoomend",m),f&&r.on("resize",l),this._oldMoveHandler=d,this._oldZoomStartHandler=u,this._oldZoomEndHandler=m,f&&(this._oldResizeHandler=l),n=!1},dispose:function(t,e){var o=t.getComponent("amap");o.getAMap().destroy(),o.setAMap(null),o.setEchartsLayer(null)}});a.registerCoordinateSystem("amap",s),a.registerAction({type:"amapRoam",event:"amapRoam",update:"updateLayout"},(function(t,e){e.eachComponent("amap",(function(t){var e=t.getAMap(),o=e.getCenter();t.setCenterAndZoom([o.lng,o.lat],e.getZoom())}))}))}])}));
//# sourceMappingURL=echarts-extension-amap.min.js.map