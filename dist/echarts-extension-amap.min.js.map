{"version":3,"file":"echarts-extension-amap.min.js","sources":["../src/helper.js","../src/AMapCoordSys.js","../src/AMapModel.js","../src/AMapView.js","../src/index.js","../index.js"],"sourcesContent":["import { version } from 'echarts/lib/echarts'\r\n\r\nexport const isV5 = version.split('.')[0] > 4\r\n\r\n// `AMap.version` only exists in AMap 2.x\r\n// For AMap 1.x, it's `AMap.v`\r\nexport const isAMap2X = AMap.version >= 2\r\n\r\nexport function v2Equal(a, b) {\r\n  return a && b && a[0] === b[0] && a[1] === b[1]\r\n}\r\n\r\nlet logMap = {}\r\n\r\nexport function logWarn(tag, msg, once) {\r\n  const log = `[ECharts][Extension][AMap]${tag ? ' ' + tag + ':' : ''} ${msg}`\r\n  once && logMap[log] || console.warn(log)\r\n  once && (logMap[log] = true)\r\n}\r\n\r\nexport function clearLogMap() {\r\n  logMap = {}\r\n}\r\n","/* global AMap */\r\n\r\nimport { util as zrUtil, graphic, matrix } from 'echarts/lib/echarts'\r\nimport { logWarn } from './helper'\r\n\r\nfunction dataToCoordSize(dataSize, dataItem) {\r\n  dataItem = dataItem || [0, 0];\r\n  return zrUtil.map(\r\n    [0, 1],\r\n    function(dimIdx) {\r\n      const val = dataItem[dimIdx]\r\n      const halfSize = dataSize[dimIdx] / 2\r\n      const p1 = []\r\n      const p2 = []\r\n      p1[dimIdx] = val - halfSize\r\n      p2[dimIdx] = val + halfSize\r\n      p1[1 - dimIdx] = p2[1 - dimIdx] = dataItem[1 - dimIdx]\r\n      return Math.abs(\r\n        this.dataToPoint(p1)[dimIdx] - this.dataToPoint(p2)[dimIdx]\r\n      )\r\n    },\r\n    this\r\n  )\r\n}\r\n\r\n// exclude private and unsupported options\r\nconst excludedOptions = [\r\n  'echartsLayerZIndex', // DEPRECATED since v1.9.0\r\n  'echartsLayerInteractive',\r\n  'renderOnMoving',\r\n  'largeMode',\r\n  'returnMapCameraState',\r\n  'layers'\r\n]\r\n\r\nfunction AMapCoordSys(amap, api) {\r\n  this._amap = amap\r\n  this._api = api\r\n  this._mapOffset = [0, 0]\r\n  // this.dimensions = ['lng', 'lat']\r\n}\r\n\r\nconst AMapCoordSysProto = AMapCoordSys.prototype\r\n\r\nAMapCoordSysProto.setZoom = function(zoom) {\r\n  this._zoom = zoom\r\n}\r\n\r\nAMapCoordSysProto.setCenter = function(center) {\r\n  const lnglat = new AMap.LngLat(center[0], center[1])\r\n  this._center = this._amap.lngLatToContainer(lnglat)\r\n}\r\n\r\nAMapCoordSysProto.setMapOffset = function(mapOffset) {\r\n  this._mapOffset = mapOffset\r\n}\r\n\r\nAMapCoordSysProto.setAMap = function(amap) {\r\n  this._amap = amap\r\n}\r\n\r\nAMapCoordSysProto.getAMap = function() {\r\n  return this._amap\r\n}\r\n\r\nAMapCoordSysProto.dataToPoint = function(data) {\r\n  const lnglat = new AMap.LngLat(data[0], data[1])\r\n  const px = this._amap.lngLatToContainer(lnglat)\r\n  const mapOffset = this._mapOffset\r\n  return [px.x - mapOffset[0], px.y - mapOffset[1]]\r\n}\r\n\r\nAMapCoordSysProto.pointToData = function(pt) {\r\n  const mapOffset = this._mapOffset\r\n  const lnglat = this._amap.containerToLngLat(\r\n    new AMap.Pixel(\r\n      pt[0] + mapOffset[0],\r\n      pt[1] + mapOffset[1]\r\n    )\r\n  )\r\n  return [lnglat.lng, lnglat.lat]\r\n}\r\n\r\nAMapCoordSysProto.getViewRect = function() {\r\n  const api = this._api\r\n  return new graphic.BoundingRect(0, 0, api.getWidth(), api.getHeight())\r\n}\r\n\r\nAMapCoordSysProto.getRoamTransform = function() {\r\n  return matrix.create()\r\n}\r\n\r\nAMapCoordSysProto.prepareCustoms = function() {\r\n  const rect = this.getViewRect()\r\n  return {\r\n    coordSys: {\r\n      // The name exposed to user is always 'cartesian2d' but not 'grid'.\r\n      type: 'amap',\r\n      x: rect.x,\r\n      y: rect.y,\r\n      width: rect.width,\r\n      height: rect.height\r\n    },\r\n    api: {\r\n      coord: zrUtil.bind(this.dataToPoint, this),\r\n      size: zrUtil.bind(dataToCoordSize, this)\r\n    }\r\n  }\r\n}\r\n\r\nAMapCoordSys.create = function(ecModel, api) {\r\n  let amapCoordSys\r\n  ecModel.eachComponent('amap', function(amapModel) {\r\n    if (typeof AMap === 'undefined') {\r\n      throw new Error('AMap api is not loaded')\r\n    }\r\n    if (amapCoordSys) {\r\n      throw new Error('Only one amap component can exist')\r\n    }\r\n    let amap = amapModel.getAMap()\r\n    const echartsLayerInteractive = amapModel.get('echartsLayerInteractive')\r\n    if (!amap) {\r\n      const root = api.getDom()\r\n      const painter = api.getZr().painter\r\n      const viewportRoot = painter.getViewportRoot()\r\n      viewportRoot.className = 'amap-ec-layer'\r\n      // PENDING not hidden?\r\n      viewportRoot.style.visibility = 'hidden'\r\n      // Not support IE8\r\n      let amapRoot = root.querySelector('.ec-extension-amap')\r\n      if (amapRoot) {\r\n        // Reset viewport left and top, which will be changed\r\n        // in moving handler in AMapView\r\n        viewportRoot.style.left = '0px'\r\n        viewportRoot.style.top = '0px'\r\n        root.removeChild(amapRoot)\r\n      }\r\n      amapRoot = document.createElement('div')\r\n      amapRoot.className = 'ec-extension-amap'\r\n      amapRoot.style.cssText = 'position:absolute;top:0;left:0;bottom:0;right:0;'\r\n      root.appendChild(amapRoot)\r\n\r\n      const options = zrUtil.clone(amapModel.get())\r\n      if ('echartsLayerZIndex' in options) {\r\n        logWarn('DEPRECATED', 'the option `echartsLayerZIndex` has been removed since v1.9.0, use `echartsLayerInteractive` instead.')\r\n      }\r\n      // delete excluded options\r\n      zrUtil.each(excludedOptions, function(key) {\r\n        delete options[key]\r\n      })\r\n\r\n      amap = new AMap.Map(amapRoot, options)\r\n\r\n      // PENDING: should update the model option when the user call map.setXXX?\r\n\r\n      // const nativeSetMapStyle = amap.setMapStyle\r\n      // const nativeSetLang = amap.setLang\r\n\r\n      // // PENDING\r\n      // amap.setMapStyle = function () {\r\n      //   nativeSetMapStyle.apply(this, arguments)\r\n      //   amapModel.__mapStyle = amap.getMapStyle()\r\n      // }\r\n\r\n      // // PENDING\r\n      // nativeSetLang && (amap.setLang = function() {\r\n      //   nativeSetLang.apply(this, arguments)\r\n      //   amapModel.__mapLang = amap.getLang()\r\n      // })\r\n\r\n      // use `complete` callback to avoid NPE when first load amap\r\n      amap.on('complete', function() {\r\n        amapRoot.querySelector('.amap-maps').appendChild(viewportRoot)\r\n        // PENDING\r\n        viewportRoot.style.visibility = ''\r\n      })\r\n\r\n      amapModel.setAMap(amap)\r\n      amapModel.setEChartsLayer(viewportRoot)\r\n\r\n      // Override\r\n      painter.getViewportRootOffset = function() {\r\n        return { offsetLeft: 0, offsetTop: 0 }\r\n      }\r\n    }\r\n\r\n    const oldEChartsLayerInteractive = amapModel.__echartsLayerInteractive\r\n    if (oldEChartsLayerInteractive !== echartsLayerInteractive) {\r\n      amapModel.setEChartsLayerInteractive(echartsLayerInteractive)\r\n      amapModel.__echartsLayerInteractive = echartsLayerInteractive\r\n    }\r\n\r\n    const center = amapModel.get('center')\r\n    const zoom = amapModel.get('zoom')\r\n    if (center && zoom) {\r\n      const amapCenter = amap.getCenter()\r\n      const amapZoom = amap.getZoom()\r\n      const centerOrZoomChanged = amapModel.centerOrZoomChanged(\r\n        [amapCenter.lng, amapCenter.lat],\r\n        amapZoom\r\n      )\r\n      if (centerOrZoomChanged) {\r\n        amap.setZoomAndCenter(zoom, new AMap.LngLat(center[0], center[1]))\r\n      }\r\n    }\r\n\r\n    // update map style(#13)\r\n    const originalMapStyle = amapModel.__mapStyle\r\n    const newMapStyle = amapModel.get('mapStyle')\r\n    if (originalMapStyle !== newMapStyle) {\r\n      amap.setMapStyle(amapModel.__mapStyle = newMapStyle)\r\n    }\r\n\r\n    // update map lang\r\n    // PENDING: AMap 2.x does not support `setLang` yet\r\n    if (amap.setLang) {\r\n      const originalMapLang = amapModel.__mapLang\r\n      const newMapLang = amapModel.get('lang')\r\n      if (originalMapLang !== newMapLang) {\r\n        amap.setLang(amapModel.__mapLang = newMapLang)\r\n      }\r\n    }\r\n    else {\r\n      logWarn('CAVEAT', 'The current map doesn\\'t support `setLang` API!', true)\r\n    }\r\n\r\n    amapCoordSys = new AMapCoordSys(amap, api)\r\n    amapCoordSys.setMapOffset(amapModel.__mapOffset || [0, 0])\r\n    amapCoordSys.setZoom(zoom)\r\n    amapCoordSys.setCenter(center)\r\n\r\n    amapModel.coordinateSystem = amapCoordSys\r\n  })\r\n\r\n  ecModel.eachSeries(function(seriesModel) {\r\n    if (seriesModel.get('coordinateSystem') === 'amap') {\r\n      seriesModel.coordinateSystem = amapCoordSys\r\n    }\r\n  })\r\n}\r\n\r\nAMapCoordSysProto.dimensions = AMapCoordSys.dimensions = ['lng', 'lat']\r\n\r\nexport default AMapCoordSys\r\n","import { ComponentModel } from 'echarts/lib/echarts'\r\nimport { isV5, v2Equal } from './helper'\r\n\r\nconst AMapModel = {\r\n  type: 'amap',\r\n\r\n  setAMap(amap) {\r\n    this.__amap = amap\r\n  },\r\n\r\n  getAMap() {\r\n    return this.__amap\r\n  },\r\n\r\n  setEChartsLayer(layer) {\r\n    this.__echartsLayer = layer\r\n  },\r\n\r\n  getEChartsLayer() {\r\n    return this.__echartsLayer\r\n  },\r\n\r\n  setEChartsLayerVisiblity(visible) {\r\n    this.__echartsLayer.style.display = visible ? 'block' : 'none'\r\n  },\r\n\r\n  // FIXME: NOT SUPPORT <= IE 10\r\n  setEChartsLayerInteractive(interactive) {\r\n    this.option.echartsLayerInteractive = !!interactive\r\n    this.__echartsLayer.style.pointerEvents = interactive ? 'auto' : 'none'\r\n  },\r\n\r\n  setCenterAndZoom(center, zoom) {\r\n    this.option.center = center\r\n    this.option.zoom = zoom\r\n  },\r\n\r\n  centerOrZoomChanged(center, zoom) {\r\n    const option = this.option\r\n    return !(v2Equal(center, option.center) && zoom === option.zoom)\r\n  },\r\n\r\n  defaultOption: {\r\n    center: [116.397428, 39.90923],\r\n    zoom: 5,\r\n    isHotspot: false,\r\n    resizeEnable: true,\r\n\r\n    // extension specific options\r\n    // echartsLayerZIndex: 2000, // DEPRECATED since v1.9.0\r\n    echartsLayerInteractive: true,\r\n    renderOnMoving: true,\r\n    largeMode: false,\r\n    // since v1.10.0\r\n    returnMapCameraState: false\r\n  }\r\n}\r\n\r\nexport default isV5\r\n  ? ComponentModel.extend(AMapModel)\r\n  : AMapModel\r\n","import { ComponentView, getInstanceByDom, throttle } from 'echarts/lib/echarts'\r\nimport { isV5, isAMap2X, clearLogMap } from './helper'\r\n\r\n/* global AMap */\r\n\r\nconst AMapView = {\r\n  type: 'amap',\r\n\r\n  init() {\r\n    this._isFirstRender = true\r\n  },\r\n\r\n  render(amapModel, ecModel, api) {\r\n    let rendering = true\r\n\r\n    const amap = amapModel.getAMap()\r\n    const viewportRoot = api.getZr().painter.getViewportRoot()\r\n    const offsetEl = amap.getContainer()\r\n    const coordSys = amapModel.coordinateSystem\r\n\r\n    const renderOnMoving = amapModel.get('renderOnMoving')\r\n    const resizeEnable = amapModel.get('resizeEnable')\r\n    const largeMode = amapModel.get('largeMode')\r\n    const returnMapCameraState = amapModel.get('returnMapCameraState')\r\n\r\n    const viewMode = amap.getViewMode_()\r\n    const is3DMode = viewMode === '3D'\r\n\r\n    let moveHandler = function(e) {\r\n      if (rendering) {\r\n        return\r\n      }\r\n\r\n      const offsetElStyle = offsetEl.style\r\n      const mapOffset = [\r\n        -parseInt(offsetElStyle.left, 10) || 0,\r\n        -parseInt(offsetElStyle.top, 10) || 0\r\n      ]\r\n      // only update style when map offset changed\r\n      const viewportRootStyle = viewportRoot.style\r\n      const offsetLeft = mapOffset[0] + 'px'\r\n      const offsetTop = mapOffset[1] + 'px'\r\n      if (viewportRootStyle.left !== offsetLeft) {\r\n        viewportRootStyle.left = offsetLeft\r\n      }\r\n      if (viewportRootStyle.top !== offsetTop) {\r\n        viewportRootStyle.top = offsetTop\r\n      }\r\n\r\n      coordSys.setMapOffset(amapModel.__mapOffset = mapOffset)\r\n\r\n      const actionParams = {\r\n        type: 'amapRoam',\r\n        animation: {\r\n          // compatible with ECharts 5.x\r\n          // no delay for rendering but remain animation of elements\r\n          duration: 0\r\n        }\r\n      }\r\n\r\n      if (returnMapCameraState) {\r\n        e = e || {}\r\n        let center = e.center\r\n        if (!center) {\r\n          // normalize center LngLat to Array\r\n          center = amap.getCenter()\r\n          center = [center.lng, center.lat]\r\n        }\r\n        actionParams.camera = {\r\n          viewMode,\r\n          center,\r\n          zoom: e.zoom || amap.getZoom(),\r\n          rotation: e.rotation == null ? amap.getRotation() : e.rotation,\r\n          pitch: e.pitch == null ? amap.getPitch() : e.pitch,\r\n          scale: amap.getScale(),\r\n          bounds: amap.getBounds()\r\n        }\r\n      }\r\n\r\n      api.dispatchAction(actionParams)\r\n    }\r\n\r\n    amap.off('mapmove', this._moveHandler)\r\n    amap.off('moveend', this._moveHandler)\r\n    amap.off('viewchange', this._moveHandler)\r\n    amap.off('camerachange', this._moveHandler)\r\n    amap.off('zoom', this._moveHandler)\r\n\r\n    if (this._resizeHandler) {\r\n      amap.off('resize', this._resizeHandler)\r\n    }\r\n    if (this._moveStartHandler) {\r\n      amap.off('movestart', this._moveStartHandler)\r\n    }\r\n    if (this._moveEndHandler) {\r\n      amap.off('moveend', this._moveEndHandler)\r\n      amap.off('zoomend', this._moveEndHandler)\r\n    }\r\n\r\n    amap.on(\r\n      renderOnMoving\r\n        ? (isAMap2X\r\n          ? 'viewchange'\r\n          : is3DMode\r\n            ? 'camerachange'\r\n            : 'mapmove')\r\n        : 'moveend',\r\n      // FIXME: bad performance in 1.x in the cases with large data, use debounce?\r\n      // moveHandler\r\n      (!isAMap2X && largeMode) ? (moveHandler = throttle(moveHandler, 20, true)) : moveHandler\r\n    )\r\n\r\n    this._moveHandler = moveHandler\r\n\r\n    if (renderOnMoving && !(isAMap2X && is3DMode)) {\r\n      // need to listen to zoom if 1.x & 2D mode\r\n      // FIXME: unnecessary `mapmove` event triggered when zooming\r\n      amap.on('zoom', moveHandler)\r\n    }\r\n\r\n    if (!renderOnMoving) {\r\n      amap.on('movestart', this._moveStartHandler = function(e) {\r\n        setTimeout(function() {\r\n          amapModel.setEChartsLayerVisiblity(false)\r\n        }, 0)\r\n      })\r\n      const moveEndHandler = this._moveEndHandler = function(e) {\r\n        ;(!e || e.type !== 'moveend') && moveHandler(e)\r\n        setTimeout(function() {\r\n          amapModel.setEChartsLayerVisiblity(true)\r\n        }, isAMap2X || !largeMode ? 0 : 20)\r\n      }\r\n      amap.on('moveend', moveEndHandler)\r\n      amap.on('zoomend', moveEndHandler)\r\n      if (this._isFirstRender && is3DMode) {\r\n        // FIXME: not rewrite AMap instance method\r\n        const nativeSetPicth = amap.setPitch\r\n        const nativeSetRotation = amap.setRotation\r\n        amap.setPitch = function() {\r\n          nativeSetPicth.apply(this, arguments)\r\n          moveEndHandler()\r\n        }\r\n        amap.setRotation = function() {\r\n          nativeSetRotation.apply(this, arguments)\r\n          moveEndHandler()\r\n        }\r\n      }\r\n    }\r\n\r\n    if (resizeEnable) {\r\n      let resizeHandler = function() {\r\n        getInstanceByDom(api.getDom()).resize()\r\n      }\r\n      if (!isAMap2X && largeMode) {\r\n        resizeHandler = throttle(resizeHandler, 20, true)\r\n      }\r\n      amap.on('resize', this._resizeHandler = resizeHandler)\r\n    }\r\n\r\n    this._isFirstRender = rendering = false\r\n  },\r\n\r\n  dispose(ecModel) {\r\n    clearLogMap()\r\n    const component = ecModel.getComponent('amap')\r\n    if (component) {\r\n      component.getAMap().destroy()\r\n      component.setAMap(null)\r\n      component.setEChartsLayer(null)\r\n      if (component.coordinateSystem) {\r\n        component.coordinateSystem.setAMap(null)\r\n        component.coordinateSystem = null\r\n      }\r\n      delete this._moveHandler\r\n      delete this._resizeHandler\r\n      delete this._moveStartHandler\r\n      delete this._moveEndHandler\r\n    }\r\n  }\r\n}\r\n\r\nexport default isV5\r\n  ? ComponentView.extend(AMapView)\r\n  : AMapView\r\n","/**\n * AMap component extension\n */\n\nimport AMapCoordSys from './AMapCoordSys'\nimport AMapModel from './AMapModel'\nimport AMapView from './AMapView'\nimport { isV5 } from './helper'\n\nexport { version, name } from '../package.json'\n\nexport function install(registers) {\n  // Model\n  isV5\n    ? registers.registerComponentModel(AMapModel)\n    : registers.extendComponentModel(AMapModel)\n  // View\n  isV5\n    ? registers.registerComponentView(AMapView)\n    : registers.extendComponentView(AMapView)\n  // Coordinate System\n  registers.registerCoordinateSystem('amap', AMapCoordSys)\n  // Action\n  registers.registerAction(\n    {\n      type: 'amapRoam',\n      event: 'amapRoam',\n      update: 'updateLayout'\n    },\n    function(payload, ecModel) {\n      ecModel.eachComponent('amap', function(amapModel) {\n        const amap = amapModel.getAMap()\n        const center = amap.getCenter()\n        amapModel.setCenterAndZoom([center.lng, center.lat], amap.getZoom())\n      })\n    }\n  )\n}\n","/**\r\n * TODO use `echarts/core` rather than `echarts/lib/echarts`\r\n * to avoid self-registered `CanvasRenderer` and `DataSetComponent` in Apache ECharts 5\r\n * but it's not compatible with echarts v4. Leave it to 2.0.\r\n */\r\nimport * as echarts from 'echarts/lib/echarts'\r\nimport { install } from './src/index'\r\nimport { isV5 } from './src/helper'\r\n\r\nisV5 ? echarts.use(install) : install(echarts)\r\n\r\nexport { name, version } from './src/index'\r\n"],"names":["isV5","version","split","isAMap2X","AMap","logMap","logWarn","tag","msg","once","log","console","warn","dataToCoordSize","dataSize","dataItem","zrUtil","map","dimIdx","val","halfSize","p1","p2","Math","abs","this","dataToPoint","excludedOptions","AMapCoordSys","amap","api","_amap","_api","_mapOffset","AMapCoordSysProto","prototype","setZoom","zoom","_zoom","setCenter","center","lnglat","LngLat","_center","lngLatToContainer","setMapOffset","mapOffset","setAMap","getAMap","data","px","x","y","pointToData","pt","containerToLngLat","Pixel","lng","lat","getViewRect","graphic","BoundingRect","getWidth","getHeight","getRoamTransform","matrix","create","prepareCustoms","rect","coordSys","type","width","height","coord","bind","size","ecModel","amapCoordSys","eachComponent","amapModel","Error","echartsLayerInteractive","get","root","getDom","painter","getZr","viewportRoot","getViewportRoot","className","style","visibility","amapRoot","querySelector","left","top","removeChild","document","createElement","cssText","appendChild","options","clone","each","key","Map","on","setEChartsLayer","getViewportRootOffset","offsetLeft","offsetTop","__echartsLayerInteractive","setEChartsLayerInteractive","amapCenter","getCenter","amapZoom","getZoom","centerOrZoomChanged","setZoomAndCenter","originalMapStyle","__mapStyle","newMapStyle","setMapStyle","setLang","originalMapLang","__mapLang","newMapLang","__mapOffset","coordinateSystem","eachSeries","seriesModel","dimensions","AMapModel","__amap","layer","__echartsLayer","getEChartsLayer","setEChartsLayerVisiblity","visible","display","interactive","option","pointerEvents","setCenterAndZoom","a","b","defaultOption","isHotspot","resizeEnable","renderOnMoving","largeMode","returnMapCameraState","ComponentModel","extend","AMapView","init","_isFirstRender","render","rendering","offsetEl","getContainer","viewMode","getViewMode_","is3DMode","moveHandler","e","offsetElStyle","parseInt","viewportRootStyle","actionParams","animation","duration","camera","rotation","getRotation","pitch","getPitch","scale","getScale","bounds","getBounds","dispatchAction","off","_moveHandler","_resizeHandler","_moveStartHandler","_moveEndHandler","throttle","setTimeout","moveEndHandler","nativeSetPicth","setPitch","nativeSetRotation","setRotation","apply","arguments","resizeHandler","getInstanceByDom","resize","dispose","component","getComponent","destroy","ComponentView","install","registers","registerComponentModel","extendComponentModel","registerComponentView","extendComponentView","registerCoordinateSystem","registerAction","event","update","payload","echarts","use"],"mappings":"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"}