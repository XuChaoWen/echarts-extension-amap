{"version":3,"file":"echarts-extension-amap.js","sources":["../src/helper.js","../src/AMapCoordSys.js","../src/AMapModel.js","../src/AMapView.js","../src/index.js","../index.js"],"sourcesContent":["import { version } from 'echarts/lib/echarts'\r\n\r\nexport const isV5 = version.split('.')[0] > 4\r\n\r\n// `AMap.version` only exists in AMap 2.x\r\n// For AMap 1.x, it's `AMap.v`\r\nexport const isAMap2X = AMap.version >= 2\r\n\r\nexport function v2Equal(a, b) {\r\n  return a && b && a[0] === b[0] && a[1] === b[1]\r\n}\r\n\r\nlet logMap = {}\r\n\r\nexport function logWarn(tag, msg, once) {\r\n  const log = `[ECharts][Extension][AMap]${tag ? ' ' + tag + ':' : ''} ${msg}`\r\n  once && logMap[log] || console.warn(log)\r\n  once && (logMap[log] = true)\r\n}\r\n\r\nexport function clearLogMap() {\r\n  logMap = {}\r\n}\r\n","/* global AMap */\r\n\r\nimport { util as zrUtil, graphic, matrix } from 'echarts/lib/echarts'\r\nimport { logWarn } from './helper'\r\n\r\nfunction dataToCoordSize(dataSize, dataItem) {\r\n  dataItem = dataItem || [0, 0];\r\n  return zrUtil.map(\r\n    [0, 1],\r\n    function(dimIdx) {\r\n      const val = dataItem[dimIdx]\r\n      const halfSize = dataSize[dimIdx] / 2\r\n      const p1 = []\r\n      const p2 = []\r\n      p1[dimIdx] = val - halfSize\r\n      p2[dimIdx] = val + halfSize\r\n      p1[1 - dimIdx] = p2[1 - dimIdx] = dataItem[1 - dimIdx]\r\n      return Math.abs(\r\n        this.dataToPoint(p1)[dimIdx] - this.dataToPoint(p2)[dimIdx]\r\n      )\r\n    },\r\n    this\r\n  )\r\n}\r\n\r\n// exclude private and unsupported options\r\nconst excludedOptions = [\r\n  'echartsLayerZIndex', // DEPRECATED since v1.9.0\r\n  'echartsLayerInteractive',\r\n  'renderOnMoving',\r\n  'largeMode',\r\n  'returnMapCameraState',\r\n  'layers'\r\n]\r\n\r\nfunction AMapCoordSys(amap, api) {\r\n  this._amap = amap\r\n  this._api = api\r\n  this._mapOffset = [0, 0]\r\n  // this.dimensions = ['lng', 'lat']\r\n}\r\n\r\nconst AMapCoordSysProto = AMapCoordSys.prototype\r\n\r\nAMapCoordSysProto.setZoom = function(zoom) {\r\n  this._zoom = zoom\r\n}\r\n\r\nAMapCoordSysProto.setCenter = function(center) {\r\n  const lnglat = new AMap.LngLat(center[0], center[1])\r\n  this._center = this._amap.lngLatToContainer(lnglat)\r\n}\r\n\r\nAMapCoordSysProto.setMapOffset = function(mapOffset) {\r\n  this._mapOffset = mapOffset\r\n}\r\n\r\nAMapCoordSysProto.setAMap = function(amap) {\r\n  this._amap = amap\r\n}\r\n\r\nAMapCoordSysProto.getAMap = function() {\r\n  return this._amap\r\n}\r\n\r\nAMapCoordSysProto.dataToPoint = function(data) {\r\n  const lnglat = new AMap.LngLat(data[0], data[1])\r\n  const px = this._amap.lngLatToContainer(lnglat)\r\n  const mapOffset = this._mapOffset\r\n  return [px.x - mapOffset[0], px.y - mapOffset[1]]\r\n}\r\n\r\nAMapCoordSysProto.pointToData = function(pt) {\r\n  const mapOffset = this._mapOffset\r\n  const lnglat = this._amap.containerToLngLat(\r\n    new AMap.Pixel(\r\n      pt[0] + mapOffset[0],\r\n      pt[1] + mapOffset[1]\r\n    )\r\n  )\r\n  return [lnglat.lng, lnglat.lat]\r\n}\r\n\r\nAMapCoordSysProto.getViewRect = function() {\r\n  const api = this._api\r\n  return new graphic.BoundingRect(0, 0, api.getWidth(), api.getHeight())\r\n}\r\n\r\nAMapCoordSysProto.getRoamTransform = function() {\r\n  return matrix.create()\r\n}\r\n\r\nAMapCoordSysProto.prepareCustoms = function() {\r\n  const rect = this.getViewRect()\r\n  return {\r\n    coordSys: {\r\n      // The name exposed to user is always 'cartesian2d' but not 'grid'.\r\n      type: 'amap',\r\n      x: rect.x,\r\n      y: rect.y,\r\n      width: rect.width,\r\n      height: rect.height\r\n    },\r\n    api: {\r\n      coord: zrUtil.bind(this.dataToPoint, this),\r\n      size: zrUtil.bind(dataToCoordSize, this)\r\n    }\r\n  }\r\n}\r\n\r\nAMapCoordSys.create = function(ecModel, api) {\r\n  let amapCoordSys\r\n  ecModel.eachComponent('amap', function(amapModel) {\r\n    if (typeof AMap === 'undefined') {\r\n      throw new Error('AMap api is not loaded')\r\n    }\r\n    if (amapCoordSys) {\r\n      throw new Error('Only one amap component can exist')\r\n    }\r\n    let amap = amapModel.getAMap()\r\n    const echartsLayerInteractive = amapModel.get('echartsLayerInteractive')\r\n    if (!amap) {\r\n      const root = api.getDom()\r\n      const painter = api.getZr().painter\r\n      const viewportRoot = painter.getViewportRoot()\r\n      viewportRoot.className = 'amap-ec-layer'\r\n      // PENDING not hidden?\r\n      viewportRoot.style.visibility = 'hidden'\r\n      // Not support IE8\r\n      let amapRoot = root.querySelector('.ec-extension-amap')\r\n      if (amapRoot) {\r\n        // Reset viewport left and top, which will be changed\r\n        // in moving handler in AMapView\r\n        viewportRoot.style.left = '0px'\r\n        viewportRoot.style.top = '0px'\r\n        root.removeChild(amapRoot)\r\n      }\r\n      amapRoot = document.createElement('div')\r\n      amapRoot.className = 'ec-extension-amap'\r\n      amapRoot.style.cssText = 'position:absolute;top:0;left:0;bottom:0;right:0;'\r\n      root.appendChild(amapRoot)\r\n\r\n      const options = zrUtil.clone(amapModel.get())\r\n      if ('echartsLayerZIndex' in options) {\r\n        logWarn('DEPRECATED', 'the option `echartsLayerZIndex` has been removed since v1.9.0, use `echartsLayerInteractive` instead.')\r\n      }\r\n      // delete excluded options\r\n      zrUtil.each(excludedOptions, function(key) {\r\n        delete options[key]\r\n      })\r\n\r\n      amap = new AMap.Map(amapRoot, options)\r\n\r\n      // PENDING: should update the model option when the user call map.setXXX?\r\n\r\n      // const nativeSetMapStyle = amap.setMapStyle\r\n      // const nativeSetLang = amap.setLang\r\n\r\n      // // PENDING\r\n      // amap.setMapStyle = function () {\r\n      //   nativeSetMapStyle.apply(this, arguments)\r\n      //   amapModel.__mapStyle = amap.getMapStyle()\r\n      // }\r\n\r\n      // // PENDING\r\n      // nativeSetLang && (amap.setLang = function() {\r\n      //   nativeSetLang.apply(this, arguments)\r\n      //   amapModel.__mapLang = amap.getLang()\r\n      // })\r\n\r\n      // use `complete` callback to avoid NPE when first load amap\r\n      amap.on('complete', function() {\r\n        amapRoot.querySelector('.amap-maps').appendChild(viewportRoot)\r\n        // PENDING\r\n        viewportRoot.style.visibility = ''\r\n      })\r\n\r\n      amapModel.setAMap(amap)\r\n      amapModel.setEChartsLayer(viewportRoot)\r\n\r\n      // Override\r\n      painter.getViewportRootOffset = function() {\r\n        return { offsetLeft: 0, offsetTop: 0 }\r\n      }\r\n    }\r\n\r\n    const oldEChartsLayerInteractive = amapModel.__echartsLayerInteractive\r\n    if (oldEChartsLayerInteractive !== echartsLayerInteractive) {\r\n      amapModel.setEChartsLayerInteractive(echartsLayerInteractive)\r\n      amapModel.__echartsLayerInteractive = echartsLayerInteractive\r\n    }\r\n\r\n    const center = amapModel.get('center')\r\n    const zoom = amapModel.get('zoom')\r\n    if (center && zoom) {\r\n      const amapCenter = amap.getCenter()\r\n      const amapZoom = amap.getZoom()\r\n      const centerOrZoomChanged = amapModel.centerOrZoomChanged(\r\n        [amapCenter.lng, amapCenter.lat],\r\n        amapZoom\r\n      )\r\n      if (centerOrZoomChanged) {\r\n        amap.setZoomAndCenter(zoom, new AMap.LngLat(center[0], center[1]))\r\n      }\r\n    }\r\n\r\n    // update map style(#13)\r\n    const originalMapStyle = amapModel.__mapStyle\r\n    const newMapStyle = amapModel.get('mapStyle')\r\n    if (originalMapStyle !== newMapStyle) {\r\n      amap.setMapStyle(amapModel.__mapStyle = newMapStyle)\r\n    }\r\n\r\n    // update map lang\r\n    // PENDING: AMap 2.x does not support `setLang` yet\r\n    if (amap.setLang) {\r\n      const originalMapLang = amapModel.__mapLang\r\n      const newMapLang = amapModel.get('lang')\r\n      if (originalMapLang !== newMapLang) {\r\n        amap.setLang(amapModel.__mapLang = newMapLang)\r\n      }\r\n    }\r\n    else {\r\n      logWarn('CAVEAT', 'The current map doesn\\'t support `setLang` API!', true)\r\n    }\r\n\r\n    amapCoordSys = new AMapCoordSys(amap, api)\r\n    amapCoordSys.setMapOffset(amapModel.__mapOffset || [0, 0])\r\n    amapCoordSys.setZoom(zoom)\r\n    amapCoordSys.setCenter(center)\r\n\r\n    amapModel.coordinateSystem = amapCoordSys\r\n  })\r\n\r\n  ecModel.eachSeries(function(seriesModel) {\r\n    if (seriesModel.get('coordinateSystem') === 'amap') {\r\n      seriesModel.coordinateSystem = amapCoordSys\r\n    }\r\n  })\r\n}\r\n\r\nAMapCoordSysProto.dimensions = AMapCoordSys.dimensions = ['lng', 'lat']\r\n\r\nexport default AMapCoordSys\r\n","import { ComponentModel } from 'echarts/lib/echarts'\r\nimport { isV5, v2Equal } from './helper'\r\n\r\nconst AMapModel = {\r\n  type: 'amap',\r\n\r\n  setAMap(amap) {\r\n    this.__amap = amap\r\n  },\r\n\r\n  getAMap() {\r\n    return this.__amap\r\n  },\r\n\r\n  setEChartsLayer(layer) {\r\n    this.__echartsLayer = layer\r\n  },\r\n\r\n  getEChartsLayer() {\r\n    return this.__echartsLayer\r\n  },\r\n\r\n  setEChartsLayerVisiblity(visible) {\r\n    this.__echartsLayer.style.display = visible ? 'block' : 'none'\r\n  },\r\n\r\n  // FIXME: NOT SUPPORT <= IE 10\r\n  setEChartsLayerInteractive(interactive) {\r\n    this.option.echartsLayerInteractive = !!interactive\r\n    this.__echartsLayer.style.pointerEvents = interactive ? 'auto' : 'none'\r\n  },\r\n\r\n  setCenterAndZoom(center, zoom) {\r\n    this.option.center = center\r\n    this.option.zoom = zoom\r\n  },\r\n\r\n  centerOrZoomChanged(center, zoom) {\r\n    const option = this.option\r\n    return !(v2Equal(center, option.center) && zoom === option.zoom)\r\n  },\r\n\r\n  defaultOption: {\r\n    center: [116.397428, 39.90923],\r\n    zoom: 5,\r\n    isHotspot: false,\r\n    resizeEnable: true,\r\n\r\n    // extension specific options\r\n    // echartsLayerZIndex: 2000, // DEPRECATED since v1.9.0\r\n    echartsLayerInteractive: true,\r\n    renderOnMoving: true,\r\n    largeMode: false,\r\n    // since v1.10.0\r\n    returnMapCameraState: false\r\n  }\r\n}\r\n\r\nexport default isV5\r\n  ? ComponentModel.extend(AMapModel)\r\n  : AMapModel\r\n","import { ComponentView, getInstanceByDom, throttle } from 'echarts/lib/echarts'\r\nimport { isV5, isAMap2X, clearLogMap } from './helper'\r\n\r\n/* global AMap */\r\n\r\nconst AMapView = {\r\n  type: 'amap',\r\n\r\n  init() {\r\n    this._isFirstRender = true\r\n  },\r\n\r\n  render(amapModel, ecModel, api) {\r\n    let rendering = true\r\n\r\n    const amap = amapModel.getAMap()\r\n    const viewportRoot = api.getZr().painter.getViewportRoot()\r\n    const offsetEl = amap.getContainer()\r\n    const coordSys = amapModel.coordinateSystem\r\n\r\n    const renderOnMoving = amapModel.get('renderOnMoving')\r\n    const resizeEnable = amapModel.get('resizeEnable')\r\n    const largeMode = amapModel.get('largeMode')\r\n    const returnMapCameraState = amapModel.get('returnMapCameraState')\r\n\r\n    const viewMode = amap.getViewMode_()\r\n    const is3DMode = viewMode === '3D'\r\n\r\n    let moveHandler = function(e) {\r\n      if (rendering) {\r\n        return\r\n      }\r\n\r\n      const offsetElStyle = offsetEl.style\r\n      const mapOffset = [\r\n        -parseInt(offsetElStyle.left, 10) || 0,\r\n        -parseInt(offsetElStyle.top, 10) || 0\r\n      ]\r\n      // only update style when map offset changed\r\n      const viewportRootStyle = viewportRoot.style\r\n      const offsetLeft = mapOffset[0] + 'px'\r\n      const offsetTop = mapOffset[1] + 'px'\r\n      if (viewportRootStyle.left !== offsetLeft) {\r\n        viewportRootStyle.left = offsetLeft\r\n      }\r\n      if (viewportRootStyle.top !== offsetTop) {\r\n        viewportRootStyle.top = offsetTop\r\n      }\r\n\r\n      coordSys.setMapOffset(amapModel.__mapOffset = mapOffset)\r\n\r\n      const actionParams = {\r\n        type: 'amapRoam',\r\n        animation: {\r\n          // compatible with ECharts 5.x\r\n          // no delay for rendering but remain animation of elements\r\n          duration: 0\r\n        }\r\n      }\r\n\r\n      if (returnMapCameraState) {\r\n        e = e || {}\r\n        let center = e.center\r\n        if (!center) {\r\n          // normalize center LngLat to Array\r\n          center = amap.getCenter()\r\n          center = [center.lng, center.lat]\r\n        }\r\n        actionParams.camera = {\r\n          viewMode,\r\n          center,\r\n          zoom: e.zoom || amap.getZoom(),\r\n          rotation: e.rotation == null ? amap.getRotation() : e.rotation,\r\n          pitch: e.pitch == null ? amap.getPitch() : e.pitch,\r\n          scale: amap.getScale(),\r\n          bounds: amap.getBounds()\r\n        }\r\n      }\r\n\r\n      api.dispatchAction(actionParams)\r\n    }\r\n\r\n    amap.off('mapmove', this._moveHandler)\r\n    amap.off('moveend', this._moveHandler)\r\n    amap.off('viewchange', this._moveHandler)\r\n    amap.off('camerachange', this._moveHandler)\r\n    amap.off('zoom', this._moveHandler)\r\n\r\n    if (this._resizeHandler) {\r\n      amap.off('resize', this._resizeHandler)\r\n    }\r\n    if (this._moveStartHandler) {\r\n      amap.off('movestart', this._moveStartHandler)\r\n    }\r\n    if (this._moveEndHandler) {\r\n      amap.off('moveend', this._moveEndHandler)\r\n      amap.off('zoomend', this._moveEndHandler)\r\n    }\r\n\r\n    amap.on(\r\n      renderOnMoving\r\n        ? (isAMap2X\r\n          ? 'viewchange'\r\n          : is3DMode\r\n            ? 'camerachange'\r\n            : 'mapmove')\r\n        : 'moveend',\r\n      // FIXME: bad performance in 1.x in the cases with large data, use debounce?\r\n      // moveHandler\r\n      (!isAMap2X && largeMode) ? (moveHandler = throttle(moveHandler, 20, true)) : moveHandler\r\n    )\r\n\r\n    this._moveHandler = moveHandler\r\n\r\n    if (renderOnMoving && !(isAMap2X && is3DMode)) {\r\n      // need to listen to zoom if 1.x & 2D mode\r\n      // FIXME: unnecessary `mapmove` event triggered when zooming\r\n      amap.on('zoom', moveHandler)\r\n    }\r\n\r\n    if (!renderOnMoving) {\r\n      amap.on('movestart', this._moveStartHandler = function(e) {\r\n        setTimeout(function() {\r\n          amapModel.setEChartsLayerVisiblity(false)\r\n        }, 0)\r\n      })\r\n      const moveEndHandler = this._moveEndHandler = function(e) {\r\n        ;(!e || e.type !== 'moveend') && moveHandler(e)\r\n        setTimeout(function() {\r\n          amapModel.setEChartsLayerVisiblity(true)\r\n        }, isAMap2X || !largeMode ? 0 : 20)\r\n      }\r\n      amap.on('moveend', moveEndHandler)\r\n      amap.on('zoomend', moveEndHandler)\r\n      if (this._isFirstRender && is3DMode) {\r\n        // FIXME: not rewrite AMap instance method\r\n        const nativeSetPicth = amap.setPitch\r\n        const nativeSetRotation = amap.setRotation\r\n        amap.setPitch = function() {\r\n          nativeSetPicth.apply(this, arguments)\r\n          moveEndHandler()\r\n        }\r\n        amap.setRotation = function() {\r\n          nativeSetRotation.apply(this, arguments)\r\n          moveEndHandler()\r\n        }\r\n      }\r\n    }\r\n\r\n    if (resizeEnable) {\r\n      let resizeHandler = function() {\r\n        getInstanceByDom(api.getDom()).resize()\r\n      }\r\n      if (!isAMap2X && largeMode) {\r\n        resizeHandler = throttle(resizeHandler, 20, true)\r\n      }\r\n      amap.on('resize', this._resizeHandler = resizeHandler)\r\n    }\r\n\r\n    this._isFirstRender = rendering = false\r\n  },\r\n\r\n  dispose(ecModel) {\r\n    clearLogMap()\r\n    const component = ecModel.getComponent('amap')\r\n    if (component) {\r\n      component.getAMap().destroy()\r\n      component.setAMap(null)\r\n      component.setEChartsLayer(null)\r\n      if (component.coordinateSystem) {\r\n        component.coordinateSystem.setAMap(null)\r\n        component.coordinateSystem = null\r\n      }\r\n      delete this._moveHandler\r\n      delete this._resizeHandler\r\n      delete this._moveStartHandler\r\n      delete this._moveEndHandler\r\n    }\r\n  }\r\n}\r\n\r\nexport default isV5\r\n  ? ComponentView.extend(AMapView)\r\n  : AMapView\r\n","/**\n * AMap component extension\n */\n\nimport AMapCoordSys from './AMapCoordSys'\nimport AMapModel from './AMapModel'\nimport AMapView from './AMapView'\nimport { isV5 } from './helper'\n\nexport { version, name } from '../package.json'\n\nexport function install(registers) {\n  // Model\n  isV5\n    ? registers.registerComponentModel(AMapModel)\n    : registers.extendComponentModel(AMapModel)\n  // View\n  isV5\n    ? registers.registerComponentView(AMapView)\n    : registers.extendComponentView(AMapView)\n  // Coordinate System\n  registers.registerCoordinateSystem('amap', AMapCoordSys)\n  // Action\n  registers.registerAction(\n    {\n      type: 'amapRoam',\n      event: 'amapRoam',\n      update: 'updateLayout'\n    },\n    function(payload, ecModel) {\n      ecModel.eachComponent('amap', function(amapModel) {\n        const amap = amapModel.getAMap()\n        const center = amap.getCenter()\n        amapModel.setCenterAndZoom([center.lng, center.lat], amap.getZoom())\n      })\n    }\n  )\n}\n","/**\r\n * TODO use `echarts/core` rather than `echarts/lib/echarts`\r\n * to avoid self-registered `CanvasRenderer` and `DataSetComponent` in Apache ECharts 5\r\n * but it's not compatible with echarts v4. Leave it to 2.0.\r\n */\r\nimport * as echarts from 'echarts/lib/echarts'\r\nimport { install } from './src/index'\r\nimport { isV5 } from './src/helper'\r\n\r\nisV5 ? echarts.use(install) : install(echarts)\r\n\r\nexport { name, version } from './src/index'\r\n"],"names":["isV5","version","split","isAMap2X","AMap","v2Equal","a","b","logMap","logWarn","tag","msg","once","log","console","warn","clearLogMap","dataToCoordSize","dataSize","dataItem","zrUtil","map","dimIdx","val","halfSize","p1","p2","Math","abs","dataToPoint","excludedOptions","AMapCoordSys","amap","api","_amap","_api","_mapOffset","AMapCoordSysProto","prototype","setZoom","zoom","_zoom","setCenter","center","lnglat","LngLat","_center","lngLatToContainer","setMapOffset","mapOffset","setAMap","getAMap","data","px","x","y","pointToData","pt","containerToLngLat","Pixel","lng","lat","getViewRect","graphic","BoundingRect","getWidth","getHeight","getRoamTransform","matrix","create","prepareCustoms","rect","coordSys","type","width","height","coord","bind","size","ecModel","amapCoordSys","eachComponent","amapModel","Error","echartsLayerInteractive","get","root","getDom","painter","getZr","viewportRoot","getViewportRoot","className","style","visibility","amapRoot","querySelector","left","top","removeChild","document","createElement","cssText","appendChild","options","clone","each","key","Map","on","setEChartsLayer","getViewportRootOffset","offsetLeft","offsetTop","oldEChartsLayerInteractive","__echartsLayerInteractive","setEChartsLayerInteractive","amapCenter","getCenter","amapZoom","getZoom","centerOrZoomChanged","setZoomAndCenter","originalMapStyle","__mapStyle","newMapStyle","setMapStyle","setLang","originalMapLang","__mapLang","newMapLang","__mapOffset","coordinateSystem","eachSeries","seriesModel","dimensions","AMapModel","__amap","layer","__echartsLayer","getEChartsLayer","setEChartsLayerVisiblity","visible","display","interactive","option","pointerEvents","setCenterAndZoom","defaultOption","isHotspot","resizeEnable","renderOnMoving","largeMode","returnMapCameraState","ComponentModel","extend","AMapView","init","_isFirstRender","render","rendering","offsetEl","getContainer","viewMode","getViewMode_","is3DMode","moveHandler","e","offsetElStyle","parseInt","viewportRootStyle","actionParams","animation","duration","camera","rotation","getRotation","pitch","getPitch","scale","getScale","bounds","getBounds","dispatchAction","off","_moveHandler","_resizeHandler","_moveStartHandler","_moveEndHandler","throttle","setTimeout","moveEndHandler","nativeSetPicth","setPitch","nativeSetRotation","setRotation","apply","arguments","resizeHandler","getInstanceByDom","resize","dispose","component","getComponent","destroy","ComponentView","install","registers","registerComponentModel","extendComponentModel","registerComponentView","extendComponentView","registerCoordinateSystem","registerAction","event","update","payload","echarts","use"],"mappings":"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"}